## 一、目标

掌握针对不同类型数据所使用的方法

## 二、知识要点

### 1.数据的分类

爬虫的步骤简单来说可以分为

> 1.定目标(明确爬取的内容-->网址等等)
>
> 2.爬数据(获取所有的内容)
>
> 3.取数据(解析数据，去掉我们不需要的数据)
>
> 4.存数据(根据自己需求存储)

其中第三步获取数据，获取到的内容一般来说分为两部分：结构化数据和非结构化数据 ，目前掌握CSS 和re正则。

**结构化数据**

结构化数据：先定义结构，再存入数据

常见的结构化数据：JSON文件及XML文件

| 数据类型 | 处理方式                   |
| -------- | -------------------------- |
| JSON文件 | JSON path                  |
|          | 利用python进行操作(json类) |
| XML文件  | XPath                      |
|          | CSS选择器                  |
|          | 正则表达式                 |
|          | 利用python进行操作         |

**非结构化数据**

非结构化数据：先有数据，再定义结构

常见的非结构化数据：文本，电话号码，邮箱地址，HTML文件等

| 数据类型                 | 处理方式   |
| ------------------------ | ---------- |
| 文本、电话号码、邮箱地址 | 正则表达式 |
| HTML文件                 | XPath      |
|                          | CSS选择器  |
|                          | 正则表达式 |

### **2.使用正则解析笑话网站**

#### 2.1确定目标

目标网站：https://xiaohua.zol.com.cn/new/

第二页：https://xiaohua.zol.com.cn/new/2.html

第三页：https://xiaohua.zol.com.cn/new/3.html

第四页：https://xiaohua.zol.com.cn/new/4.html

规律：num.html,只需修改对应的num就可以访问对应的页面



#### 2.2获取响应

python里写了

### 3.使用Xpath解析数据

**XPath**是一门在XML文档中查找信息的语言。XPath使用路径表达式来选取XML文档中的节点或节点集。

3.1什么是XML

- XML指可扩展标记语言(Extensible Markup Language)
- XML是一种标记语言，很类似HTML

- XML的设计宗旨是传输数据，而非显示数据
- XML的标签需要我们自己定义
- XML被设计为具有自我描述性
- XML是W3C的推荐标准

**XML和HTML的区别**

| 数据格式 | 描述                                         | 设计目标                                                     |
| -------- | -------------------------------------------- | ------------------------------------------------------------ |
| XML      | Extensible Markup Language(可扩展标记语言)   | 被设计为传输和存储数据，其焦点是数据的内容                   |
| HTML     | HyperText Markup(超文本标记语言)             | 显示数据以及如何更好显示数据                                 |
| HTML DOM | Document Object Model for HTML(文档对象模型) | 通过HTML DOM，可以访问所有的HTML元素，连同它们所包含的文本和属性。可以对其中的内容进行修改和删除，同时也可以创建新的元素。 |

### 3.2XPath开发工具

1.开源的XPath表达式编辑工具:XMLQuire(XML格式文件可用)

2.Chrome插件Path Helper

3.Firefox插件 XPath Checker

3.3选取节点

XPath使用路径表达式来选取XML文档中的节点或者节点集

| 表达式   | 描述                                                     |
| -------- | -------------------------------------------------------- |
| Nodename | 选取此节点的所有子节点                                   |
| /        | 从根节点选取                                             |
| //       | 从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置 |
| .        | 选取当前节点                                             |
| ..       | 选取当前节点的父节点                                     |
| @        | 选取属性                                                 |

**举个例子**

| 路径表达式 | 结果                                                         |
| ---------- | ------------------------------------------------------------ |
| div        | 选取div元素的所有子节点                                      |
| /div       | 选取根元素div，注意：假如路径起始于正斜杠(/),则此路径始终代表到div元素的绝对路径 |
| div/p      | 选取属于div的子元素的所有p元素                               |
| //div      | 选取所有div子元素，而且不管它们在文档中的位置                |
| div//p     | 选择属于div元素的后代的所有p元素，而且不管它们位于div之下的什么位置 |
| //@box1    | 选取名为box1的所有属性                                       |

**使用通配符选取未知节点**

| 通配符 | 描述               |
| ------ | ------------------ |
| *      | 匹配任何元素节点   |
| @*     | 匹配任何属性节点   |
| node() | 匹配任何类型的节点 |

**举个例子**

| 路径表达式          | 结果                                       |
| ------------------- | ------------------------------------------ |
| /div/*              | 选取div元素的所有子元素                    |
| //*                 | 选取文档中的所有元素                       |
| html/node()/meta/@* | 选择html下面任意节点下的meta节点的所有属性 |
| //title[@*]         | 选取所有带有属性的title元素                |

### **3.4XPath初体验**

- 如果有图片从src2--->src，要怎么做

  ```python
  src=html.xpath("//div[@class='container']/div[2]/div/img/@src2") #最后这里换乘src2就好了
  ```



### 4.JSON

JSON(JavaScript Object Notation)也是一种轻量级的数据交换格式，它使得人们很容易的进行阅读和编写。同时也方便了机器进行解析和生成。适用于进行数据交互的场景，比如网站前台与后台之间的数据交互。

#### 4.1python处理json

在python中内置了一个json模块json,用来处理json数据，该模块提供了四个功能：

```python
dumps、dump、loads、load
```

用于字符串和python数据类型间进行转换。

**Json.loads():把json格式字符串解码转换成python对象**

#### 4.2JsonPath(了解)

JsonPath是一种信息抽取类库，是从JSON文档中抽取指定信息的工具。JsonPath对于JSON来说，相当于XPATH对于XML。

| XPath | JSONPath | 描述                                                         |
| ----- | -------- | ------------------------------------------------------------ |
| /     | $        | 根节点                                                       |
| .     | @        | 现行节点                                                     |
| /     | .or[]    | 取子节点                                                     |
| ..    | n/a      | 取父节点，JsonPath未支持                                     |
| //    | ..       | 就是不管位置，选择所有符合的条件                             |
| *     | *        | 匹配所有元素节点                                             |
| @     | n/a      | 根据属性访问，json不支持，因为json是个ke y-value递归结构，不需要 |
| []    | []       | 迭代器标示(可以在里面做简单的迭代操作，如数组下标，根据内容选值等) |
| ｜    | [,]      | 支持迭代器中做多选                                           |
| []    | ?()      | 支持过滤操作                                                 |
| n/a   | ()       | 支持表达式计算                                               |
| （）  | n/a      | 分组，JsonPath不支持                                         |

### 三、总结

xpath优先，然后搞不行正则
